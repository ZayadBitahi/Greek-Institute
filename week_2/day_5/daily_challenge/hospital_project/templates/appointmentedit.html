{% extends "base.html" %}
{% block title %}Edit Appointment{% endblock %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tom-select/dist/css/tom-select.css">
<div class="bg-white shadow-md rounded p-6 max-w-2xl mx-auto">
  <h2 class="text-2xl font-semibold text-gray-800 mb-4">Edit Appointment</h2>
  <form action="/appointment/edit/{{ appointment[0] }}" method="POST" class="space-y-4">
    <div>
      <label class="block mb-1 text-gray-700">Patient</label>
      <select id="patient_id" name="patient_id" class="w-full border rounded px-3 py-2" required>
        {% for p in patients %}
        <option value="{{ p[0] }}" {% if p[0] == appointment[1] %}selected{% endif %}>{{ p[1] }} {{ p[2] }} (ID {{ p[0] }})</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label class="block mb-1 text-gray-700">Doctor</label>
      <select id="doctor_id" name="doctor_id" class="w-full border rounded px-3 py-2" required>
        {% for d in doctors %}
        <option value="{{ d[0] }}" {% if d[0] == appointment[2] %}selected{% endif %}>{{ d[1] }} {{ d[2] }} â€” {{ d[3] }} (ID {{ d[0] }})</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label class="block mb-1 text-gray-700">Appointment Date/Time</label>
      <input type="datetime-local" name="appointment_date" value="{{ appointment[3]|replace(' ', 'T') }}" class="w-full border rounded px-3 py-2" required>
    </div>
    <div>
      <label class="block mb-1 text-gray-700">Reason</label>
      <input type="text" name="reason" value="{{ appointment[4] }}" class="w-full border rounded px-3 py-2">
    </div>
    <div class="flex justify-end gap-3 pt-2">
      <a href="/appointment" class="bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 transition">Cancel</a>
      <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition">Update</button>
    </div>
  </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/tom-select/dist/js/tom-select.complete.min.js"></script>
<script>
new TomSelect('#patient_id',{create:false,sortField:{field:'text',direction:'asc'},placeholder:'Search patient...'});
new TomSelect('#doctor_id',{create:false,sortField:{field:'text',direction:'asc'},placeholder:'Search doctor...'});
</script>
{% endblock %}

